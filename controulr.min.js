/*
 Controller v1.0.0
 (c) 2014 Kyle Shay. http://kyleshay.info
 License: MIT
*/
var Controller=Controller||{};Controller=function(e,t){function r(t){t.preventDefault();var r=t.target;if(t.target==e)return;n[r.getAttribute("id")].handle(t)}function i(e,t){var n=Math.floor((window.innerWidth||document.documentElement.offsetWidth)/t),r=Math.floor((window.innerHeight||document.documentElement.offsetHeight)/e);var i=document.getElementById("grid-parent");if(!i){i=document.createElement("div");i.id="grid-parent";i.className="grid";i.style.width=n*t+"px";i.style.height=r*e+"px"}i.innerHTML="";for(var s=0;s<e;s++){for(var o=0;o<t;o++){i.innerHTML+="<div style='"+"width:"+(n-1)+"px;"+"height:"+(r-1)+"px"+"'></div>"}}document.body.appendChild(i);return{w:Math.floor((window.innerWidth||document.documentElement.offsetWidth)/t),h:Math.floor((window.innerHeight||document.documentElement.offsetHeight)/e)}}var n=[];var s=i(20,30);if(t.supportmouse){e.addEventListener("mousemove",r);e.addEventListener("mouseup",r);e.addEventListener("mousedown",r)}e.addEventListener("touchstart",r);e.addEventListener("touchmove",r);e.addEventListener("touchend",r);this.add=function(t){n[t.element().getAttribute("id")]=t;var r=t.element();r.style.position="absolute",r.style.left=s.w*t.position().left,r.style.top=s.h*t.position().top,r.style.width=s.w*t.size().width-1,r.style.height=s.h*t.size().height-1;e.appendChild(r)}};var Controller=Controller||{};Controller.Button=function(e){var t,n,r,i,s,o;if(e.start)i=e.start;if(e.end)s=e.end;if(e.buttons)o=e.buttons;r=e.position||{top:0,left:0};n=e.size||{width:1,height:1};t=document.createElement("div");t.id="button"+e.text;t.className="button";t.style.borderRadius=e.round?"100px":"";t.style.backgroundColor=e.color||"";t.innerText=e.text||"x";this.handle=function(e){switch(e.type){case"mousedown":case"touchstart":e.target.className+=" active";i(e);break;case"mouseup":case"touchend":e.target.className=e.target.className.replace(" active","");s(e);break}};this.element=function(){return t};this.position=function(){return r};this.size=function(){return n}};var Controller=Controller||{};Controller.Touchpad=function(e){var t,n,r,i,s,o;if(e.start)i=e.start;if(e.end)s=e.end;if(e.move)o=e.move;r=e.position||{top:0,left:0};n=e.size||{width:2,height:2};t=document.createElement("div");t.id="touchpad";if(e.style)t.style.cssText=e.style;var u=d=p={x:0,y:0};this.handle=function(e){switch(e.type){case"mousedown":case"touchstart":d={x:0,y:0};u={x:e.x||e.changedTouches[0].clientX,y:e.y||e.changedTouches[0].clientY};i();break;case"mousemove":case"touchmove":d.x=u.x-e.x||e.changedTouches[0].clientX;d.y=u.y-e.y||e.changedTouches[0].clientY;o();break;case"mouseup":case"touchend":p.x-=d.x;p.y-=d.x;s();break}};this.touch=function(){return{x:p.x-d.x,y:p.x-d.y}};this.element=function(){return t};this.position=function(){return r};this.size=function(){return n}}